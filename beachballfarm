if game.PlaceId == 142823291 then
    -- Services
    local Players = game:GetService('Players')
    local CoreGUI = game:GetService('CoreGui')
    local TweenService = game:GetService('TweenService')
    local UserInputService = game:GetService("UserInputService")
    local Player = Players.LocalPlayer
    local Character = Player.Character or Player.CharacterAdded:Wait()
    local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
    local HIDEUI = get_hidden_gui or gethui
    getgenv().coinFarm = false
    local delay = 0.1 -- задержка между монетами

    -- Перехват смены персонажа
    Player.CharacterAdded:Connect(function(char)
        Character = char
        HumanoidRootPart = char:WaitForChild("HumanoidRootPart")
    end)

    -- GUI
    local ScreenGui = Instance.new('ScreenGui')
    local MainFrame = Instance.new('Frame')
    local HeaderFrame = Instance.new('Frame')
    local MainButton = Instance.new('TextButton')
    local Description = Instance.new('TextLabel')

    local function Hide_UI(gui)
        if HIDEUI then
            gui.Parent = HIDEUI()
        elseif syn and syn.protect_gui then
            syn.protect_gui(gui)
            gui.Parent = CoreGUI
        else
            gui.Parent = CoreGUI
        end
    end

    local function MakeDraggable(gui)
        local dragging, dragInput, dragStart, startPos
        local function update(input)
            local delta = input.Position - dragStart
            gui.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
                                     startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
        gui.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = gui.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                    end
                end)
            end
        end)
        gui.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement then
                dragInput = input
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                update(input)
            end
        end)
    end

    -- Создание GUI
    ScreenGui.Name = "CoinFarmGUI"
    ScreenGui.ResetOnSpawn = false
    Hide_UI(ScreenGui)

    MainFrame.Size = UDim2.new(0, 250, 0, 130)
    MainFrame.Position = UDim2.new(0.5, -125, 0.5, -65)
    MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    MainFrame.Parent = ScreenGui
    MakeDraggable(MainFrame)

    local uicorner = Instance.new("UICorner", MainFrame)
    uicorner.CornerRadius = UDim.new(0, 10)

    HeaderFrame.Size = UDim2.new(1, 0, 0, 25)
    HeaderFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    HeaderFrame.Parent = MainFrame
    Instance.new("UICorner", HeaderFrame).CornerRadius = UDim.new(0, 10)

    Description.Text = "MM2 BeachBall Farm"
    Description.Size = UDim2.new(1, 0, 0, 25)
    Description.Position = UDim2.new(0, 0, 0, 30)
    Description.BackgroundTransparency = 1
    Description.TextColor3 = Color3.fromRGB(255, 255, 255)
    Description.Font = Enum.Font.Gotham
    Description.TextSize = 14
    Description.Parent = MainFrame

    MainButton.Size = UDim2.new(1, -20, 0, 40)
    MainButton.Position = UDim2.new(0, 10, 0, 80)
    MainButton.Text = "Working: OFF"
    MainButton.TextColor3 = Color3.fromRGB(255, 100, 100)
    MainButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    MainButton.Font = Enum.Font.Gotham
    MainButton.TextSize = 14
    MainButton.Parent = MainFrame
    Instance.new("UICorner", MainButton).CornerRadius = UDim.new(0, 10)

    -- Логика фарма
    local function getNearestCoin()
        local nearestCoin, nearestDistance = nil, math.huge
        for _, descendant in pairs(workspace:GetDescendants()) do
            if descendant:IsA("Part") and descendant.Name == "Coin_Server" then
                if descendant:GetAttribute("CoinID") == "BeachBall" then
                    local dist = (HumanoidRootPart.Position - descendant.Position).Magnitude
                    if dist < nearestDistance and dist < 200 then -- максимальная дистанция поиска
                        nearestCoin = descendant
                        nearestDistance = dist
                    end
                end
            end
        end
        return nearestCoin
    end

    local function farmCoins()
        task.spawn(function()
            while getgenv().coinFarm do
                local coin = getNearestCoin()
                if coin and HumanoidRootPart then
                    local distance = (HumanoidRootPart.Position - coin.Position).Magnitude
                    local tweenTime = math.clamp(distance / 60, 0.3, 1.2)

                    local tween = TweenService:Create(HumanoidRootPart, TweenInfo.new(tweenTime, Enum.EasingStyle.Linear), {
                        CFrame = coin.CFrame + Vector3.new(0, 4, 0)
                    })

                    tween:Play()
                    tween.Completed:Wait()
                    task.wait(delay)
                else
                    task.wait(0.3)
                end
            end
        end)
    end

    -- Кнопка вкл/выкл
    MainButton.MouseButton1Click:Connect(function()
        getgenv().coinFarm = not getgenv().coinFarm
        if getgenv().coinFarm then
            MainButton.Text = "Working: ON"
            MainButton.TextColor3 = Color3.fromRGB(100, 255, 100)
            farmCoins()
        else
            MainButton.Text = "Working: OFF"
            MainButton.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
    end)
end
