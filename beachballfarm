if game.PlaceId == 142823291 then
    local Players = game:GetService("Players")
    local CoreGui = game:GetService("CoreGui")
    local TweenService = game:GetService("TweenService")
    local UserInputService = game:GetService("UserInputService")

    local LocalPlayer = Players.LocalPlayer
    local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

    getgenv().coinFarm = false

    -- GUI
    local ScreenGui = Instance.new("ScreenGui", CoreGui)
    ScreenGui.Name = "MM2Farm"
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.ResetOnSpawn = false

    local Frame = Instance.new("Frame", ScreenGui)
    Frame.Size = UDim2.new(0, 150, 0, 50)
    Frame.Position = UDim2.new(0, 100, 0, 100)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 10)

    local Button = Instance.new("TextButton", Frame)
    Button.Size = UDim2.new(1, -10, 1, -10)
    Button.Position = UDim2.new(0, 5, 0, 5)
    Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    Button.TextColor3 = Color3.new(1, 1, 1)
    Button.Font = Enum.Font.GothamBold
    Button.TextSize = 14
    Button.Text = "AutoFarm: OFF"
    Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 8)

    -- Drag
    local dragging, dragStart, startPos
    Frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = Frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    -- Main Farm Logic
    local function coinFarm()
        while getgenv().coinFarm and task.wait(0.1) do
            local map = nil
            for _, m in ipairs(workspace:GetDescendants()) do
                if m:IsA("Model") and m.Name == "CoinContainer" then
                    map = m
                    break
                end
            end
            if not map then continue end

            local Character = LocalPlayer.Character
            if not Character or not Character:FindFirstChild("HumanoidRootPart") then continue end
            local hrp = Character.HumanoidRootPart

            local coins = {}
            for _, coin in ipairs(map:GetChildren()) do
                if coin:IsA("Part") and coin.Name == "Coin_Server" and coin:GetAttribute("CoinID") == "BeachBall" then
                    local visual = coin:FindFirstChild("CoinVisual")
                    if visual and visual.Transparency ~= 1 then
                        table.insert(coins, coin)
                    end
                end
            end

            table.sort(coins, function(a, b)
                return (a.Position - hrp.Position).Magnitude < (b.Position - hrp.Position).Magnitude
            end)

            for i = 1, math.min(3, #coins) do
                local coin = coins[i]
                if not coin or not coin:IsDescendantOf(workspace) then continue end

                local dist = (hrp.Position - coin.Position).Magnitude
                if dist < 4 then continue end -- рядом уже

                local goal = {CFrame = coin.CFrame * CFrame.new(0, 6, 0)}
                local tTime = math.clamp(dist / 50, 0.4, 1.1)

                local tween = TweenService:Create(hrp, TweenInfo.new(tTime, Enum.EasingStyle.Linear), goal)
                tween:Play()
                tween.Completed:Wait()
                task.wait(0.05)
            end
        end
    end

    -- Toggle
    local toggled = false
    Button.MouseButton1Click:Connect(function()
        toggled = not toggled
        getgenv().coinFarm = toggled

        if toggled then
            Button.Text = "AutoFarm: ON"
            Button.BackgroundColor3 = Color3.fromRGB(40, 100, 40)
            task.spawn(coinFarm)
        else
            Button.Text = "AutoFarm: OFF"
            Button.BackgroundColor3 = Color3.fromRGB(100, 40, 40)
        end
    end)
end
