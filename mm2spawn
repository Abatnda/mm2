local lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Eazvy/UILibs/main/Librarys/Random/Example.lua"))()
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")

local plr = Players.LocalPlayer
local character = plr.Character or plr.CharacterAdded:Wait()
local humPart = character:WaitForChild("HumanoidRootPart")

-- Обновление character при смерти
plr.CharacterAdded:Connect(function(char)
    character = char
    humPart = char:WaitForChild("HumanoidRootPart")
end)

local map
game.Workspace.DescendantAdded:Connect(function(m)
    if m:IsA("Model") and m.Name == "CoinContainer" then
        map = m
    end
end)

local delay = 0.1
getgenv().farm = false

-- Интерфейс
lib:Button("Start BeachBall Farm", function()
    getgenv().farm = true
    task.spawn(function()
        while getgenv().farm do
            if (not map) or (not map.Parent) then
                for _,m in ipairs(game.Workspace:GetDescendants()) do
                    if m:IsA("Model") and m.Name == "CoinContainer" then
                        map = m
                        break
                    end
                end
            end

            if map and map.Parent then
                for _,coin in ipairs(map:GetChildren()) do
                    if not getgenv().farm then break end
                    if coin:IsA("Part") and coin.Name == "Coin_Server" and coin:GetAttribute("CoinID") == "BeachBall" then
                        local cv = coin:FindFirstChild("CoinVisual")
                        if cv and cv.Transparency ~= 1 then
                            if not humPart or not humPart.Parent then
                                humPart = character and character:FindFirstChild("HumanoidRootPart")
                                if not humPart then break end
                            end

                            -- Отключение столкновений
                            for _,p in pairs(character:GetChildren()) do
                                if p:IsA("BasePart") and p.CanCollide then
                                    p.CanCollide = false
                                end
                            end

                            -- Tween до монеты
                            local goal = {CFrame = coin.CFrame * CFrame.new(0, 6, 0)}
                            local dist = (humPart.Position - coin.Position).Magnitude
                            local tweenTime = math.clamp(dist / 25, 0.5, 2)
                            local tween = TweenService:Create(humPart, TweenInfo.new(tweenTime, Enum.EasingStyle.Linear), goal)
                            tween:Play()
                            tween.Completed:Wait()

                            task.wait(delay)
                        end
                    end
                end
            end
            task.wait(0.5)
        end
    end)
end)

lib:Button("Stop Farm", function()
    getgenv().farm = false
end)

lib:Box("Set Delay (seconds)", function(txt)
    local num = tonumber(txt)
    if num then delay = num end
end)

lib:Button("Anti AFK", function()
    local vu = cloneref(game:GetService("VirtualUser"))
    plr.Idled:Connect(function()
        vu:CaptureController()
        vu:ClickButton2(Vector2.new())
    end)
end)

lib:Notify("MM2 Farm Loaded!", 3)
