local TeleportService = game:GetService("TeleportService")
local PlaceId = 126884695634066 -- сюда твой PlaceId

-- Перехватчик + перезаход + вебхук + print на новом сервере
TeleportService.TeleportInitFailed:Connect(function(_, _, _, _, teleportResult)
    local serverId = teleportResult.ServerInstanceId

    -- Код, который выполнится на новом сервере
    queue_on_teleport(string.format([[
        getgenv().JobId = "%s"

        -- Код на новом сервере
        print("hello world core lol")

        -- Лог в Discord
        task.wait(2)
        local webhookUrl = "https://discord.com/api/webhooks/1413919894017413203/n3A3GU2C3Z0IhX-TMu3tKjFbCOgOG00Zss4QhhD3VwiCnJxAFlcGKeh6HqTdhaTKr2w4"
        local message = "Сервер сгенерирован! JobId: `" .. getgenv().JobId .. "`"
        local data = {["content"] = message, ["username"] = "JobId Logger"}
        local jsonData = game:GetService("HttpService"):JSONEncode(data)

        local success, response = pcall(function()
            return syn.request({
                Url = webhookUrl,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = jsonData
            })
        end)

        if not success then
            warn("Ошибка отправки в Discord: " .. tostring(response))
        else
            print("JobId успешно отправлен в Discord!")
        end
    ]], serverId))

    -- Перезаход на пойманный сервер
    task.spawn(function()
        TeleportService:TeleportToPlaceInstance(PlaceId, serverId)
    end)
end)

-- Начальный телепорт, если JobId уже есть
for _ = 1, 2 do
    task.spawn(function()
        TeleportService:TeleportToPlaceInstance(PlaceId, game.JobId)
    end)
    task.wait()
end
